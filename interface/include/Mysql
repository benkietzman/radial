// -*- C++ -*-
// Radial
// -------------------------------------
// file       : Mysql
// author     : Ben Kietzman
// begin      : 2022-04-21
// copyright  : Ben Kietzman
// email      : ben@kietzman.org
#ifndef _RADIAL_MYSQL_
#define _RADIAL_MYSQL_
// {{{ includes
#include <mysql/mysql.h>
#include "Interface"
// }}}
extern "C++"
{
namespace radial
{
// {{{ Mysql
class Mysql : public Interface
{
  protected:
  map<string, string> *fetch(MYSQL_RES *result, vector<string> subFields);
  bool fields(MYSQL_RES *result, vector<string> &subFields);
  void free(MYSQL_RES *result);
  MYSQL_RES *query(MYSQL *conn, const string strQuery, unsigned long long &ullRows, string &strError);
  bool update(MYSQL *conn, const string strQuery, unsigned long long &ullID, unsigned long long &ullRows, string &strError);

  public:
  Mysql(string strPrefix, int argc, char **argv, void (*pCallback)(string, const string, const bool));
  ~Mysql();
  void callback(string strPrefix, const string strPacket, const bool bResponse);
};
// }}}
}
}
#endif
